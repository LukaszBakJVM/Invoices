Index: src/main/java/org/lukasz/faktury/views/invoice/NewInvoiceView.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.lukasz.faktury.views.invoice;\r\n\r\nimport com.vaadin.flow.component.UI;\r\nimport com.vaadin.flow.component.button.Button;\r\nimport com.vaadin.flow.component.button.ButtonVariant;\r\nimport com.vaadin.flow.component.combobox.ComboBox;\r\nimport com.vaadin.flow.component.datepicker.DatePicker;\r\nimport com.vaadin.flow.component.formlayout.FormLayout;\r\nimport com.vaadin.flow.component.grid.Grid;\r\nimport com.vaadin.flow.component.grid.dataview.GridListDataView;\r\nimport com.vaadin.flow.component.html.Div;\r\nimport com.vaadin.flow.component.html.H1;\r\nimport com.vaadin.flow.component.html.Span;\r\nimport com.vaadin.flow.component.icon.Icon;\r\nimport com.vaadin.flow.component.icon.VaadinIcon;\r\nimport com.vaadin.flow.component.notification.Notification;\r\nimport com.vaadin.flow.component.orderedlayout.HorizontalLayout;\r\nimport com.vaadin.flow.component.orderedlayout.VerticalLayout;\r\nimport com.vaadin.flow.component.textfield.BigDecimalField;\r\nimport com.vaadin.flow.component.textfield.IntegerField;\r\nimport com.vaadin.flow.component.textfield.TextField;\r\nimport com.vaadin.flow.router.Route;\r\nimport jakarta.annotation.security.PermitAll;\r\nimport org.lukasz.faktury.buyer.BuyerService;\r\nimport org.lukasz.faktury.buyer.dto.BuyerDto;\r\nimport org.lukasz.faktury.exceptions.*;\r\nimport org.lukasz.faktury.invoices.InvoicesService;\r\nimport org.lukasz.faktury.invoices.dto.InvoicesDto;\r\nimport org.lukasz.faktury.invoices.dto.InvoicesPdf;\r\nimport org.lukasz.faktury.items.InvoiceItemsService;\r\nimport org.lukasz.faktury.items.dto.InvoiceItemsDto;\r\nimport org.lukasz.faktury.seller.SellerDto;\r\nimport org.lukasz.faktury.seller.SellerService;\r\nimport org.lukasz.faktury.utils.pdfenerator.PDFGenerator;\r\nimport org.lukasz.faktury.views.user.DashboardView;\r\n\r\nimport java.io.IOException;\r\nimport java.math.BigDecimal;\r\nimport java.time.LocalDate;\r\nimport java.util.ArrayList;\r\nimport java.util.Base64;\r\nimport java.util.List;\r\nimport java.util.concurrent.atomic.AtomicBoolean;\r\n\r\n\r\n@Route(\"newinvoice\")\r\n@PermitAll\r\n\r\npublic class NewInvoiceView extends VerticalLayout {\r\n\r\n\r\n    private final BuyerService buyerService;\r\n    private final List<InvoiceItemsDto> items = new ArrayList<>();\r\n    private final PDFGenerator pdfGenerator;\r\n\r\n    private final InvoiceItemsService invoiceItemsService;\r\n    private final InvoicesService invoicesService;\r\n    private final AtomicBoolean updating;\r\n\r\n    private final TextField nipField;\r\n    private final ComboBox<String> tax;\r\n    private final ComboBox<String> unit;\r\n    // dane faktury\r\n    private final TextField numberField = new TextField(\"Numer faktury\");\r\n    private final DatePicker dateOfIssueField = new DatePicker(\"Data wystawienia\");\r\n    private final TextField placeField = new TextField(\"Miejsce wystawienia\");\r\n    private final DatePicker dateOfSaleField = new DatePicker(\"Data sprzedaży\");\r\n    private final IntegerField postponementField = new IntegerField(\"Odroczenie (dni)\");\r\n    private final DatePicker paymentDateField = new DatePicker(\"Termin płatności\");\r\n    private final ComboBox<String> paymentTypeField = new ComboBox<>(\"Forma płatności\");\r\n\r\n    //Buyer\r\n\r\n    private TextField companyNameField;\r\n\r\n\r\n\r\n    //items\r\n    private final Grid<InvoiceItemsDto> invoiceItemsGrid;\r\n    private final GridListDataView<InvoiceItemsDto> dataView;\r\n\r\n    private final TextField descriptionField = new TextField(\"Nazwa\");\r\n    private final IntegerField quantityField = new IntegerField(\"Ilość\");\r\n    private final BigDecimalField nettoField = new BigDecimalField(\"Cena Netto\");\r\n    private final BigDecimalField bruttoField = new BigDecimalField(\"Cena Brutto\");\r\n    private final BigDecimalField totalValue = new BigDecimalField(\"Wartość\");\r\n\r\n    Button homeButton = new Button(\"← Powrót na poprzednia stronę\", e -> UI.getCurrent().navigate(DashboardView.class));\r\n    private final BigDecimalField sumNettoField = new BigDecimalField(\"Suma netto\");\r\n    private final BigDecimalField sumTaxField = new BigDecimalField(\"Podatek\");\r\n    private final BigDecimalField sumBruttoField = new BigDecimalField(\"Suma brutto\");\r\n\r\n\r\n    private final VerticalLayout buyerDataLayout;\r\n\r\n    public NewInvoiceView(BuyerService buyerService, SellerService sellerService, PDFGenerator pdfGenerator, InvoiceItemsService invoiceItemsService, InvoicesService invoicesService, AtomicBoolean updating) {\r\n        this.buyerService = buyerService;\r\n        this.pdfGenerator = pdfGenerator;\r\n        this.invoiceItemsService = invoiceItemsService;\r\n        this.invoicesService = invoicesService;\r\n        this.updating = updating;\r\n\r\n\r\n        setSizeFull();\r\n        setPadding(true);\r\n        setSpacing(true);\r\n\r\n        H1 header = new H1(\"\uD83D\uDCDD Wystaw fakturę\");\r\n        header.getStyle().set(\"text-align\", \"center\");\r\n        add(header);\r\n        setHorizontalComponentAlignment(Alignment.CENTER, header);\r\n\r\n        HorizontalLayout centerLayout = new HorizontalLayout();\r\n        centerLayout.setWidthFull();\r\n        centerLayout.setJustifyContentMode(JustifyContentMode.BETWEEN);\r\n\r\n\r\n        FormLayout invoiceHeaderLayout = new FormLayout();\r\n        invoiceHeaderLayout.setWidth(\"650px\");\r\n        invoiceHeaderLayout.setResponsiveSteps(new FormLayout.ResponsiveStep(\"0\", 7));\r\n        invoiceHeaderLayout.setWidthFull();\r\n\r\n\r\n        //nr faktury\r\n        numberField.setValue(invoicesService.invoicesNumber());\r\n\r\n        //data platnosci\r\n\r\n        dateOfIssueField.addValueChangeListener(e -> calculatePaymentDate());\r\n        postponementField.addValueChangeListener(e -> calculatePaymentDate());\r\n\r\n\r\n        //  typ płatności pobierany z serwisu\r\n\r\n\r\n\r\n        paymentTypeField.setItems(invoicesService.paymentsMethod());\r\n\r\n        invoiceHeaderLayout.add(numberField, dateOfIssueField, placeField, dateOfSaleField, postponementField, paymentDateField, paymentTypeField);\r\n\r\n        add(invoiceHeaderLayout);\r\n\r\n\r\n        VerticalLayout leftLayout = new VerticalLayout();\r\n        leftLayout.setWidth(\"300px\");\r\n        leftLayout.setPadding(true);\r\n//sprzedawca lewa strona\r\n        Span sellerTitle = new Span(\"Sprzedawca\");\r\n        sellerTitle.getStyle().set(\"font-weight\", \"bold\");\r\n\r\n        SellerDto seller = sellerService.findByUserEmail();\r\n        Span name = new Span(\"Firma: \" + seller.name());\r\n        Span nip = new Span(\"NIP: \" + seller.nip());\r\n        Span regon = new Span(\"REGON: \" + seller.regon());\r\n        Span address = new Span(\"Adres: \" + seller.street() + \" \" + seller.houseNumber() + \", \" + seller.zipCode() + \" \" + seller.city());\r\n\r\n        leftLayout.add(sellerTitle, name, nip, regon, address);\r\n\r\n        // Nabynca prawa strona\r\n        VerticalLayout rightLayout = new VerticalLayout();\r\n        rightLayout.setWidth(\"300px\");\r\n        rightLayout.setPadding(true);\r\n\r\n        Span buyerTitle = new Span(\"Nabywca\");\r\n        buyerTitle.getStyle().set(\"font-weight\", \"bold\");\r\n\r\n        nipField = new TextField(\"NIP kontrahenta\");\r\n        Button loadButton = new Button(\"Wczytaj\", event -> findByNip());\r\n\r\n        buyerDataLayout = new VerticalLayout(); // dane nabywcy\r\n        buyerDataLayout.setSpacing(false);\r\n        buyerDataLayout.setPadding(false);\r\n\r\n        VerticalLayout centerInvoice = new VerticalLayout();\r\n\r\n// faktura\r\n\r\n\r\n        invoiceItemsGrid = new Grid<>(InvoiceItemsDto.class, false);\r\n        dataView = invoiceItemsGrid.setItems(items);\r\n\r\n\r\n        invoiceItemsGrid.addColumn(item -> {\r\n            int index = new ArrayList<>(dataView.getItems().toList()).indexOf(item) + 1;\r\n            return String.valueOf(index);\r\n        }).setHeader(\"Lp\");\r\n\r\n\r\n\r\n\r\n\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::description).setHeader(\"Nazwa\");\r\n\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::quantity).setHeader(\"iość\");\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::unit).setHeader(\"Jednostka\");\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::priceNetto).setHeader(\"Cena Netto\");\r\n\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::tax).setHeader(\"Vat\");\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::priceBrutto).setHeader(\"Cena Brutto\");\r\n\r\n        invoiceItemsGrid.addColumn(InvoiceItemsDto::totalValue).setHeader(\"Wartośc\");\r\n\r\n        invoiceItemsGrid.addComponentColumn(this::deleteButton);\r\n\r\n\r\n        centerInvoice.setWidthFull();\r\n\r\n\r\n\r\n        descriptionField.setWidth(\"150px\");\r\n\r\n\r\n        quantityField.setWidth(\"150px\");\r\n        quantityField.addValueChangeListener(event->calculateTotalValue());\r\n\r\n        unit = new ComboBox<>(\"Jednostka\");\r\n        unit.setItems(invoiceItemsService.unit());\r\n        unit.setWidth(\"150px\");\r\n        unit.setPlaceholder(\"Jednostka\");\r\n\r\n\r\n        nettoField.setWidth(\"150px\");\r\n\r\n\r\n        nettoField.addValueChangeListener(event -> nettoToBrutto());\r\n\r\n\r\n\r\n\r\n        tax = new ComboBox<>(\"Vat\");\r\n        tax.setItems(invoiceItemsService.tax());\r\n        tax.setWidth(\"105px\");\r\n        tax.setPlaceholder(\"Vat\");\r\n        tax.setValue(\"VAT23\");\r\n\r\n\r\n        bruttoField.setWidth(\"105px\");\r\n        bruttoField.addValueChangeListener(event -> bruttoToNetto());\r\n        bruttoField.addValueChangeListener(event->calculateTotalValue());\r\n\r\n\r\n        totalValue.setWidth(\"105px\");\r\n\r\n\r\n        Button addItemButton = new Button(\"Dodaj pozycję\",p->addItem());\r\n\r\n\r\n        HorizontalLayout fields = new HorizontalLayout();\r\n        fields.add(descriptionField, quantityField, unit, nettoField, tax, bruttoField,totalValue);\r\n\r\n        centerInvoice.add(invoiceItemsGrid, fields, addItemButton);\r\n//pobierz\r\n        Button saveAndDownloads = new Button(\"Zapisz i pobierz\", new Icon(VaadinIcon.DOWNLOAD));\r\n        saveAndDownloads.addClickListener(event -> saveAndDownloads());\r\n\r\n\r\n        HorizontalLayout downLayout = new HorizontalLayout(saveAndDownloads, sumNettoField, sumTaxField, sumBruttoField);\r\n        Div spacer = new Div();\r\n        downLayout.add(spacer, sumNettoField, sumTaxField, sumBruttoField);\r\n        downLayout.expand(spacer);\r\n        downLayout.setJustifyContentMode(JustifyContentMode.CENTER);\r\n\r\n        centerInvoice.add(invoiceItemsGrid, downLayout, homeButton);\r\n\r\n\r\n        rightLayout.add(buyerTitle, nipField, loadButton, buyerDataLayout);\r\n\r\n\r\n\r\n        centerLayout.add(leftLayout, centerInvoice, rightLayout);\r\n        add(centerLayout);\r\n    }\r\n\r\n    private void calculatePaymentDate() {\r\n        if (dateOfIssueField.isEmpty() || postponementField.isEmpty()) {\r\n            return;\r\n        }\r\n        LocalDate dateOfIssue = dateOfIssueField.getValue();\r\n        Integer postponement = postponementField.getValue();\r\n        LocalDate paymentDate = invoicesService.calculatePaymentDate(dateOfIssue, postponement);\r\n        paymentDateField.setValue(paymentDate);\r\n\r\n\r\n    }\r\n\r\n    private void saveAndDownloads() {\r\n        try {\r\n            invoicesCheck();\r\n\r\n\r\n            InvoicesDto invoicesDto = new InvoicesDto(numberField.getValue(), dateOfIssueField.getValue(), placeField.getValue(), dateOfSaleField.getValue()\r\n                    , postponementField.getValue(), paymentDateField.getValue(), paymentTypeField.getValue());\r\n\r\n\r\n            BuyerDto buyer = buyerService.findByNipAndName(nipField.getValue(), companyNameField.getValue());\r\n\r\n            invoicesService.createInvoices(invoicesDto, buyer, items);\r\n            TotalValues totalValues = new TotalValues(sumNettoField.getValue(),sumTaxField.getValue(),sumBruttoField.getValue());\r\n\r\n            byte[] pdfBytes = pdfGenerator.generatePDF(new InvoicesPdf(invoicesDto, buyer, items,totalValues));\r\n\r\n            String number = String.format(\"%s.pdf\", invoicesDto.number());\r\n\r\n            getUI().ifPresent(ui -> ui.getPage().executeJs(\"var link = document.createElement('a');\" + \"link.href = 'data:application/pdf;base64,' + $0;\" + \"link.download = $1;\" + \"link.click();\", Base64.getEncoder().encodeToString(pdfBytes), number));\r\n\r\n\r\n            items.clear();\r\n            dataView.refreshAll();\r\n            clearInvoicesFields();\r\n\r\n        } catch (IOException | CustomValidationException | AccountNumberException | NipConflictException |\r\n                 NipNotFoundException | BuyerNotFoundException ex) {\r\n            Notification.show(ex.getMessage(),4000, Notification.Position.MIDDLE);\r\n        }\r\n\r\n    }\r\n\r\n\r\n    private void clearInvoicesFields() {\r\n        numberField.setValue(invoicesService.invoicesNumber());\r\n        dateOfIssueField.clear();\r\n        placeField.clear();\r\n        dateOfSaleField.clear();\r\n        postponementField.clear();\r\n        paymentDateField.clear();\r\n        paymentTypeField.clear();\r\n\r\n    }\r\n\r\n\r\n// znajdz po nipie\r\n\r\n    private void findByNip() {\r\n        buyerDataLayout.removeAll();\r\n        try {\r\n            BuyerDto buyer = buyerService.findByNipAndSave(nipField.getValue());\r\n            companyNameField = new TextField(\"Firma\");\r\n            TextField nipFieldForm = new TextField(\"NIP\");\r\n            TextField regonField = new TextField(\"REGON\");\r\n            TextField streetField = new TextField(\"Ulica\");\r\n            TextField houseNumberField = new TextField(\"Nr domu/mieszkania\");\r\n            TextField zipCodeField = new TextField(\"Kod pocztowy\");\r\n            TextField cityField = new TextField(\"Miasto\");\r\n\r\n            // Znaleziony buyer po   nip\r\n\r\n            companyNameField.setValue(buyer.name());\r\n            nipFieldForm.setValue(buyer.nip());\r\n            regonField.setValue(buyer.regon());\r\n            streetField.setValue(buyer.street());\r\n            houseNumberField.setValue(buyer.houseNumber());\r\n            zipCodeField.setValue(buyer.zipCode());\r\n            cityField.setValue(buyer.city());\r\n\r\n\r\n\r\n            Button saveButton = new Button(\"Zapisz\", e -> {\r\n                BuyerDto dto = new BuyerDto(companyNameField.getValue(), nipFieldForm.getValue(), regonField.getValue(), streetField.getValue(), houseNumberField.getValue(), zipCodeField.getValue(), cityField.getValue());\r\n                try {\r\n                    buyerService.findByNipAndNameAndSave(dto);\r\n                    Notification.show(\"Dane zapisane.\");\r\n                } catch (Exception ex) {\r\n                    Notification.show(\"Błąd przy zapisie: \" + ex.getMessage());\r\n                }\r\n            });\r\n\r\n            buyerDataLayout.add(companyNameField, nipFieldForm, regonField, streetField, houseNumberField, zipCodeField, cityField, saveButton);\r\n\r\n        } catch (Exception e) {\r\n            Notification.show(\"Błąd podczas wyszukiwania: \" + e.getMessage());\r\n        }\r\n    }\r\n\r\n\r\n    private void addItem() {\r\n\r\n\r\n           try {\r\n\r\n\r\n               InvoiceItemsDto invoiceItemsDto = getInvoiceItemsDto();\r\n               if (items.contains(invoiceItemsDto)) {\r\n                   throw new ItemExistException((\"Pozycja  już jest na fakturze\"));\r\n               }\r\n\r\n\r\n               items.add(invoiceItemsDto);\r\n               invoiceItemsGrid.setItems(items);\r\n\r\n\r\n               valueUpdate();\r\n            clearFields();\r\n\r\n\r\n           } catch (CustomValidationException | ItemExistException ex) {\r\n            Notification.show(ex.getMessage(),3000, Notification.Position.MIDDLE);\r\n        }\r\n\r\n\r\n       }\r\n    private Button deleteButton(InvoiceItemsDto item) {\r\n        Button deleteButton = new Button(new Icon(VaadinIcon.TRASH));\r\n\r\n\r\n            deleteButton.addClickListener(e->{\r\n                items.remove(item);\r\n                reduceTotalValues(item.quantity(),item.priceNetto(),item.tax(),item.totalValue());\r\n                dataView.refreshAll();\r\n            });\r\n\r\n\r\n\r\n\r\n        deleteButton.addThemeVariants(ButtonVariant.LUMO_ERROR, ButtonVariant.LUMO_ICON);\r\n        return deleteButton;\r\n    }\r\n\r\n    private void reduceTotalValues(int quantity, BigDecimal priceNetto,BigDecimal tax,BigDecimal totalValue){\r\n        BigDecimal netto = sumNettoField.getValue().subtract(invoiceItemsService.reduceTotalValues(priceNetto, quantity));\r\n        sumNettoField.setValue(netto);\r\n\r\n        BigDecimal vat = sumTaxField.getValue().subtract(invoiceItemsService.reduceTotalValues(tax, quantity));\r\n        sumTaxField.setValue(vat);\r\n\r\n        BigDecimal brutto = sumBruttoField.getValue().subtract(totalValue);\r\n        sumBruttoField.setValue(brutto);\r\n\r\n\r\n    }\r\n\r\n    private InvoiceItemsDto getInvoiceItemsDto() {\r\n\r\n        if (descriptionField.getValue() == null || quantityField.getValue() == null || unit.getValue() == null || nettoField.getValue() == null || tax == null || bruttoField.getValue() == null) {\r\n            throw new CustomValidationException(\"Uzupełnij wszystkie pola\");\r\n\r\n        }\r\n\r\n        BigDecimal tax = bruttoField.getValue().subtract(nettoField.getValue());\r\n\r\n\r\n        return new InvoiceItemsDto(descriptionField.getValue(), quantityField.getValue(), unit.getValue(), nettoField.getValue(), tax, bruttoField.getValue(), totalValue.getValue());\r\n\r\n    }\r\n//wylicz netto ->brutto\r\n\r\n    private void nettoToBrutto() {\r\n        if ( updating.get()){\r\n            return;\r\n        }\r\n        updating.set(true);\r\n\r\n        BigDecimal brutto = invoiceItemsService.nettoToBrutto(nettoField.getValue(), tax.getValue());\r\n\r\n        bruttoField.setValue(brutto);\r\n        updating.set(false);\r\n\r\n\r\n    }\r\n//wylicz brutto -> netto\r\n    private void bruttoToNetto() {\r\n        if (updating.get()){\r\n            return;\r\n        }\r\n        updating.set(true);\r\n\r\n        BigDecimal netto = invoiceItemsService.bruttoToNetto(bruttoField.getValue(), tax.getValue());\r\n\r\n        nettoField.setValue(netto);\r\n        updating.set(false);\r\n\r\n\r\n    }\r\n//wyczysc pola\r\n    private void clearFields() {\r\n        updating.set(true);\r\n        descriptionField.clear();\r\n        quantityField.clear();\r\n        nettoField.clear();\r\n        bruttoField.clear();\r\n        totalValue.clear();\r\n        updating.set(false);\r\n    }\r\n//calkowita wartosc\r\n    private void valueUpdate() {\r\n\r\n        List<BigDecimal> prices = totalPrice(nettoField.getValue(), bruttoField.getValue(), quantityField.getValue());\r\n\r\n        calculateTotalTax();\r\n\r\n        sumNettoField.setValue(prices.get(0));\r\n        sumBruttoField.setValue(prices.get(1));\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    private BigDecimal checkEmpty(BigDecimalField value) {\r\n        if (value.isEmpty()) {\r\n            return BigDecimal.ZERO;\r\n        }\r\n        return value.getValue();\r\n    }\r\n    private void calculateTotalValue() {\r\n\r\n            if (bruttoField.getValue() == null || quantityField.getValue() == null) {\r\n                return;\r\n            }\r\n        BigDecimal total = invoiceItemsService.calculateTotalValue(bruttoField.getValue(), quantityField.getValue());\r\n        totalValue.setValue(total);\r\n\r\n    }\r\n    private void calculateTotalTax(){\r\n        sumTaxField.setValue(checkEmpty(sumTaxField));\r\n        BigDecimal value = sumTaxField.getValue();\r\n        BigDecimal calculateTax = bruttoField.getValue().subtract(nettoField.getValue());\r\n        BigDecimal totalTax = calculateTax.multiply(BigDecimal.valueOf(quantityField.getValue())).add(value);\r\n        sumTaxField.setValue(totalTax);\r\n\r\n    }\r\n    private List<BigDecimal> totalPrice(BigDecimal priceNetto ,BigDecimal priceBrutto,int quantity){\r\n        sumNettoField.setValue(checkEmpty(sumNettoField));\r\n        sumBruttoField.setValue(checkEmpty(sumBruttoField));\r\n\r\n        BigDecimal calculateNetto= invoiceItemsService.calculateTotalValue(priceNetto, quantity);\r\n        BigDecimal totalNetto = sumNettoField.getValue().add(calculateNetto);\r\n\r\n        BigDecimal calculateBrutto = invoiceItemsService.calculateTotalValue(priceBrutto, quantity);\r\n        BigDecimal totalBrutto = sumBruttoField.getValue().add(calculateBrutto);\r\n\r\n        return List.of(totalNetto,totalBrutto);\r\n\r\n    }\r\n\r\n    private void invoicesCheck() {\r\n        if (numberField.isEmpty() || dateOfIssueField.isEmpty() || placeField.isEmpty() || dateOfSaleField.isEmpty() || postponementField.isEmpty() || paymentDateField.isEmpty() || paymentTypeField.isEmpty()) {\r\n            throw new CustomValidationException(\"Uzupełnij wszystkie pola\");\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n
===================================================================
diff --git a/src/main/java/org/lukasz/faktury/views/invoice/NewInvoiceView.java b/src/main/java/org/lukasz/faktury/views/invoice/NewInvoiceView.java
--- a/src/main/java/org/lukasz/faktury/views/invoice/NewInvoiceView.java	
+++ b/src/main/java/org/lukasz/faktury/views/invoice/NewInvoiceView.java	
@@ -42,6 +42,8 @@
 import java.util.List;
 import java.util.concurrent.atomic.AtomicBoolean;
 
+import static javax.swing.UIManager.getUI;
+
 
 @Route("newinvoice")
 @PermitAll
